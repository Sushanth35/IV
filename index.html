<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Grocery Store Survey Dashboard</title>
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; background-color: #f5f5f5; }
        .header { text-align: center; margin-bottom: 30px; }
        .header h1 { font-size: 3em; font-weight: bold; color: #333; }
        .filter { margin-bottom: 20px; text-align: center; }
        .charts-row { display: flex; justify-content: space-around; flex-wrap: wrap; margin-bottom: 20px; }
        .chart { width: 30%; background: #ffffff; padding: 10px; border-radius: 8px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); margin-bottom: 20px; }
        svg { width: 100%; height: 400px; }
        .legend { margin-top: 10px; text-align: center; }
        .footer { text-align: center; margin-top: 40px; font-size: 0.9em; color: #555; }
    </style>
</head>
<body>
    <div class="header">
        <h1>Grocery Store Survey Dashboard</h1>
    </div>

    <div class="filter">
        <label for="genderFilter">Filter by Gender:</label>
        <select id="genderFilter">
            <option value="All">All</option>
        </select>

        <label for="paymentFilter" style="margin-left:20px;">Filter by Payment Method:</label>
        <select id="paymentFilter">
            <option value="All">All</option>
        </select>

        <label for="chainFilter" style="margin-left:20px;">Filter by Chain:</label>
        <select id="chainFilter">
            <option value="All">All</option>
        </select>
    </div>

    <div class="charts-row">
        <div class="chart" id="barChart"></div>
        <div class="chart" id="pieChart"></div>
        <div class="chart" id="scatterPlot"></div>
    </div>

    <div class="charts-row">
        <div class="chart" id="lineChart"></div>
        <div class="chart" id="donutChart"></div>
    </div>

    <div class="legend" id="legend"></div>

    <div class="footer">
        Created by Harshitha Patlolla, Varun Sai Arutla, Lakshmi Mattaparthi, Sushanth Malliboina
    </div>

    <script>
        let data;

        d3.csv("a1-grocerystoresurvey.csv").then(rawData => {
            data = rawData;
            data.forEach(d => {
                d.Age = +d.Age;
                d.Income = +d.Income;
                d.PurchaseAmount = +d.PurchaseAmount;
                d.FamilySize = +d.FamilySize;
            });
            initFilters();
            updateVisuals();
        });

        function initFilters() {
            let genders = Array.from(new Set(data.map(d => d.Gender)));
            genders.forEach(g => d3.select("#genderFilter").append("option").attr("value", g).text(g));
            let payments = Array.from(new Set(data.map(d => d.PaymentMethod)));
            payments.forEach(p => d3.select("#paymentFilter").append("option").attr("value", p).text(p));
            let chains = Array.from(new Set(data.map(d => d.Chain)));
            chains.forEach(c => d3.select("#chainFilter").append("option").attr("value", c).text(c));
            d3.select("#genderFilter").on("change", updateVisuals);
            d3.select("#paymentFilter").on("change", updateVisuals);
            d3.select("#chainFilter").on("change", updateVisuals);
        }

        function filterData() {
            let gender = d3.select("#genderFilter").property("value");
            let payment = d3.select("#paymentFilter").property("value");
            let chain = d3.select("#chainFilter").property("value");
            return data.filter(d => (gender === "All" || d.Gender === gender) && (payment === "All" || d.PaymentMethod === payment) && (chain === "All" || d.Chain === chain));
        }

        function updateVisuals() {
            let filtered = filterData();
            drawBarChart(filtered);
            drawPieChart(filtered);
            drawScatterPlot(filtered);
            drawLineChart(filtered);
            drawDonutChart(filtered);
        }

        // Drawing functions (drawBarChart, drawPieChart, drawScatterPlot, drawLineChart, drawDonutChart) remain same as previously upgraded.

    </script>
</body>
</html>
